{% extends 'base_layout.html' %}
{% load staticfiles %}
{% load get_item %}

{% block head %}
  <title>Incoming | Juicy Story</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Heebo|Lato" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/incoming.css' %}">
{% endblock %}

{% block body %}
  <div>
    <form class="allign" action="{% url 'incoming:list_images' userdata.username  %}" method="get">
      {% if userdata %}
      <img class="img-circle" src=" {{userdata.profile_picture}} ">
      {% endif %}
      <input type="text" name="tag_or_location" placeholder="search...">
      <input type="submit" value="Submit">
    </form>
  </div>
  {% if images %}
  <form class="incoming" id="incoming" action="{% url 'incoming:select_images' userdata.username %}" method="post">
    {% csrf_token %}
      <ul>
        {% for key, value in images.items %}
        <li>
          <div class="nonselected" id="{{ key }}" >
            <!-- height="288" width="162" -->
            <img src="{{ value }}">
            <div class="remove checkmark" id="{{ forloop.counter }}"></div>
            <input type="text" id="url{{ forloop.counter }}" name="url">
            <script type="text/javascript">
              function switchClass(){
                var element = getElement('{{ key }}');
                element.classList.toggle("selected");
                element.classList.toggle("nonselected");
                element = getElement("{{forloop.counter}}");
                element.classList.toggle("remove");
                var url = getElement("url{{forloop.counter}}");
                if(element.classList.contains("remove")){
                  url.value = "";
                }else{
                  url.value = "{{ value }}";
                }
              }

              getElement('{{ key }}').onclick = switchClass;
              getElement('url{{forloop.counter}}').style.display = 'none';

              function getElement(id){
                return document.getElementById(id);
              }
            </script>   
          </div>
        </li>
         {% endfor %}
      </ul>
      
      <input type="submit" value="Create Story">
  </form>
  {% elif places %}
    {% for place in places %}
      <form action="{% url 'incoming:list_images' userdata.username %}" method="get">
        {{place.name}}
        <input type="hidden" name="id" value="{{place.id}}">
        <input type="submit" value="Submit">
      </form>
      <p></p>
    {% endfor %}
  {% elif DMImages%}
    {% for key, value in DMImages.items %}
      <img src="{{ value }}" id="{{ key }}">
    {% endfor %}  
  {% endif %}
{% endblock%}
